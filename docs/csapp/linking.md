# linking

# 链接

将编译出来的多个二进制文件合成一个可执行文件。

## 为什么使用链接？

- 原因一：模块化。

  在编写代码时，我们不能把所有的代码都写在同一个源文件中，这样只会写出屎山。
- 原因二：效率。

  - 我们可以分别编译。如果我们只是修改了某一个源文件中的一句代码，我们只需要重新编译这一个文件再链接就可以，而不必重新编译整个工程。
  - 我们可以实现库。将一些常用的函数的写成了二进制文件，在后期需要使用的时候，只需要将这个二进制文件和我们的程序链接就可以。
  - 库的链接有着两种方式：静态链接和动态链接。静态链接会将需要用到的库二进制数据复制到可执行文件中。动态链接会将库二进制数据加载到内存中，其他的程序就可以利用内存地址使用库了。

## 链接做了什么？

* 符号解析

  程序中会定义或者引用需要使用的函数和全局变量，这些符号变量会储存在目标文件的符号表中。

  链接器会重新解析这张符号表，将每个符号和函数的定义同唯一的符号和函数实现对应在一起。

* 重定位

  * 将分散的代码和数据合并在一起
  * 将`.o`​​文件中代码的相对位置重定向到在可执行文件中的最终内存地址
  * 更新文件中对上面这些内容的所有引用

>  下面我们更详细的介绍这两个步骤。

#### 对象文件的三种种类

* 可重定向对象文件`.o`​​

  * 包含可以同其他`.o`​​文件合并为一个可执行文件的代码和数据
  * 每个`.o`​​是由单个`.c`​​文件产生的
* 可执行文件`.out`​​

  包含可以直接复制到内存中运行的代码和数据
* 共享库文件

  * 一种特殊类型的课重定向对象文件，可以直接加载在内存中然后动态链接，加载时链接或者运行时链接均可。
  * 在Windows操作系统中后缀为`.dll`​​

‍

‍
